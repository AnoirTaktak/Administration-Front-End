<div class="container mt-4">
  <h3 class="text-center">Ajouter Utilisateur</h3>
  <form [formGroup]="addUtilisateurForm" (ngSubmit)="save()">
    <div class="row">
      <!-- Nom -->
      <div class="col-md-6 mb-3">
        <label for="Nom_Utilisateur" class="form-label">Nom</label>
        <input
          type="text"
          id="Nom_Utilisateur"
          class="form-control"
          formControlName="Nom_Utilisateur"
          [ngClass]="{ 'is-invalid': isFieldInvalid('Nom_Utilisateur') }"
        />
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Nom_Utilisateur')?.errors?.['required']">
          Le nom est requis.
        </div>
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Nom_Utilisateur')?.errors?.['nomNotUnique']">
          Ce Nom est déjà utilisé.
        </div>
      </div>

      <!-- Pseudo -->
      <div class="col-md-6 mb-3">
        <label for="Pseudo" class="form-label">Pseudo</label>
        <input
          type="text"
          id="Pseudo"
          class="form-control"
          formControlName="Pseudo"
          [ngClass]="{ 'is-invalid': isFieldInvalid('Pseudo') }"
        />
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Pseudo')?.errors?.['required']">
          Le pseudo est requis.
        </div>
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Pseudo')?.errors?.['pseudoNotUnique']">
          Ce pseudo est déjà utilisé.
        </div>
      </div>

      <!-- Email -->
      <div class="col-md-6 mb-3">
        <label for="Email_Utilisateur" class="form-label">Email</label>
        <input
          type="email"
          id="Email_Utilisateur"
          class="form-control"
          formControlName="Email_Utilisateur"
          [ngClass]="{ 'is-invalid': isFieldInvalid('Email_Utilisateur') }"
        />
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Email_Utilisateur')?.errors?.['required']">
          L'email est requis.
        </div>
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Email_Utilisateur')?.errors?.['emailNotUnique']">
          Cet email est déjà utilisé.
        </div>
      </div>

      <!-- Mot de Passe -->
<div class="col-md-6 mb-3">
  <label for="MotDePasse_Utilisateur" class="form-label">Mot de Passe</label>
  <input
    type="password"
    id="MotDePasse_Utilisateur"
    class="form-control"
    formControlName="MotDePasse_Utilisateur"
    [ngClass]="{ 'is-invalid': isFieldInvalid('MotDePasse_Utilisateur') }"
  />
  <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('MotDePasse_Utilisateur')?.errors?.['required']">
    Le mot de passe est requis.
  </div>
  <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('MotDePasse_Utilisateur')?.errors?.['minlength']">
    Le mot de passe doit contenir au moins 6 caractères.
  </div>
  <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('MotDePasse_Utilisateur')?.errors?.['pattern']">
    Le mot de passe doit contenir au moins une lettre majuscule, un chiffre, et un caractère spécial (par exemple $!%*?&).
  </div>
</div>

      <!-- Role -->
      <div class="col-md-6 mb-3">
        <label for="Role_Utilisateur" class="form-label">Rôle</label>
        <select
          id="Role_Utilisateur"
          class="form-select"
          formControlName="Role_Utilisateur"
          [ngClass]="{ 'is-invalid': isFieldInvalid('Role_Utilisateur') }"
        >
          <option value=0>Super Admin</option>
          <option value=1>Admin</option>
          <option value=2>User</option>
        </select>
        <div class="invalid-feedback" *ngIf="addUtilisateurForm.get('Role_Utilisateur')?.errors?.['required']">
          Le rôle est requis.
        </div>
      </div>

      <!-- Buttons -->
      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-primary me-2" [disabled]="addUtilisateurForm.invalid">
          Enregistrer
        </button>
        <button type="button" class="btn btn-secondary" (click)="close()">
          Annuler
        </button>
      </div>
    </div>
  </form>
</div>
